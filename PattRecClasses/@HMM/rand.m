function [X,S]=rand(h,nSamples)%[X,S]=rand(h,nSamples);generates a random sequence of data%from a given Hidden Markov Model.%%Input:%h=         HMM object%nSamples=  maximum no of output samples (scalars or column vectors)%%Result:%X= matrix or row vector with output data samples%S= row vector with corresponding integer state values%   obtained from the h.StateGen component.%   nS= length(S) == size(X,2)= number of output samples.%   If the StateGen can generate infinite-duration sequences,%       nS == nSamples%   If the StateGen is a finite-duration MarkovChain,%       nS <= nSamples%%----------------------------------------------------%Code Authors:% Christopher Norman% Pierre Laurent%----------------------------------------------------if numel(h)>1    error('Method works only for a single object');end;k = h.OutputDistr.DataSize;S = rand(h.StateGen, nSamples);% X = zeros(k, nSamples); 8/10/2013nX=length(S);X=zeros(k,nX);for i = 1:h.StateGen.nStates%     X(:, i) = rand(h.OutputDistr(S(i)), 1); 8/10/2013     X(:,S==i)=rand(h.OutputDistr(i),sum(S==i)); endend